<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Service Ranch AI Readiness Assessment</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%233D2817'/%3E%3Ctext x='50' y='70' font-family='Arial, sans-serif' font-size='45' font-weight='bold' fill='%23D4A574' text-anchor='middle'%3ESR%3C/text%3E%3C/svg%3E">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;600;700&family=Karla:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --ranch-brown: #3D2817;
            --ranch-tan: #D4A574;
            --ranch-sage: #8B9B7E;
            --ranch-rust: #B85C38;
            --ranch-cream: #F5F1E8;
            --ranch-charcoal: #2A2520;
            --ranch-light: #FAF8F3;
        }

        body {
            font-family: 'Karla', sans-serif;
            background: linear-gradient(135deg, var(--ranch-cream) 0%, var(--ranch-light) 100%);
            color: var(--ranch-charcoal);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--ranch-tan);
        }

        .logo {
            font-family: 'Crimson Pro', serif;
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--ranch-brown);
            margin-bottom: 0;
            letter-spacing: 0.5px;
        }

        .tagline {
            font-size: 0.75rem;
            color: var(--ranch-rust);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-bottom: 0;
            display: none;
        }

        .brought-by {
            font-size: 0.7rem;
            color: var(--ranch-sage);
            font-weight: 400;
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-bottom: 2px;
        }

        h1 {
            font-family: 'Crimson Pro', serif;
            font-size: 2.2rem;
            color: var(--ranch-brown);
            margin-bottom: 15px;
            font-weight: 700;
        }

        .subtitle {
            font-size: 1.15rem;
            color: var(--ranch-charcoal);
            max-width: 700px;
            margin: 0 auto 30px;
            opacity: 0.85;
        }

        .intro-box {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(61, 40, 23, 0.1);
            margin-bottom: 40px;
            border-left: 5px solid var(--ranch-tan);
        }

        .intro-box h2 {
            font-family: 'Crimson Pro', serif;
            color: var(--ranch-brown);
            margin-bottom: 15px;
            font-size: 1.6rem;
        }

        .intro-box ul {
            list-style: none;
            margin: 15px 0;
        }

        .intro-box li {
            padding: 8px 0 8px 30px;
            position: relative;
            color: var(--ranch-charcoal);
        }

        .intro-box li::before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: var(--ranch-sage);
            font-weight: bold;
            font-size: 1.2rem;
        }

        .question-card {
            background: white;
            padding: 35px;
            margin-bottom: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(61, 40, 23, 0.08);
            border-top: 4px solid var(--ranch-sage);
            opacity: 0;
            animation: slideIn 0.5s forwards;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .question-number {
            font-size: 0.9rem;
            color: var(--ranch-rust);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .question-text {
            font-family: 'Crimson Pro', serif;
            font-size: 1.4rem;
            color: var(--ranch-brown);
            margin-bottom: 25px;
            font-weight: 600;
            line-height: 1.4;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            padding: 18px 22px;
            border: 2px solid #E5DFD4;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--ranch-light);
            font-size: 1rem;
        }

        .option:hover {
            border-color: var(--ranch-tan);
            background: white;
            transform: translateX(5px);
        }

        .option.selected {
            border-color: var(--ranch-sage);
            background: white;
            box-shadow: 0 2px 10px rgba(139, 155, 126, 0.2);
        }

        .checkbox-option {
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .checkbox-option input[type="checkbox"] {
            margin-top: 4px;
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: var(--ranch-sage);
        }

        .btn {
            background: var(--ranch-brown);
            color: white;
            border: none;
            padding: 18px 40px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Karla', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: inline-block;
        }

        .btn:hover {
            background: var(--ranch-rust);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(184, 92, 56, 0.3);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            gap: 20px;
        }

        .btn-secondary {
            background: var(--ranch-sage);
        }

        .btn-secondary:hover {
            background: var(--ranch-rust);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #E5DFD4;
            border-radius: 10px;
            margin-bottom: 40px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--ranch-sage), var(--ranch-tan));
            transition: width 0.4s ease;
            border-radius: 10px;
        }

        #email-capture {
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(61, 40, 23, 0.1);
            text-align: center;
            max-width: 600px;
            margin: 0 auto;
        }

        #email-capture h2 {
            font-family: 'Crimson Pro', serif;
            color: var(--ranch-brown);
            margin-bottom: 20px;
            font-size: 2rem;
        }

        #email-capture input {
            width: 100%;
            padding: 15px;
            font-size: 1.1rem;
            border: 2px solid #E5DFD4;
            border-radius: 6px;
            margin: 20px 0;
            font-family: 'Karla', sans-serif;
        }

        #email-capture input:focus {
            outline: none;
            border-color: var(--ranch-sage);
        }

        #results {
            animation: slideIn 0.6s forwards;
        }

        .score-header {
            background: linear-gradient(135deg, var(--ranch-brown), var(--ranch-rust));
            color: white;
            padding: 50px 40px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 40px;
            box-shadow: 0 8px 30px rgba(61, 40, 23, 0.2);
        }

        .score-number {
            font-size: 5rem;
            font-weight: 700;
            font-family: 'Crimson Pro', serif;
            margin-bottom: 10px;
        }

        .score-label {
            font-size: 2rem;
            font-family: 'Crimson Pro', serif;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .score-description {
            font-size: 1.2rem;
            opacity: 0.95;
            max-width: 600px;
            margin: 0 auto;
        }

        .results-section {
            background: white;
            padding: 40px;
            margin-bottom: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(61, 40, 23, 0.08);
        }

        .results-section h3 {
            font-family: 'Crimson Pro', serif;
            color: var(--ranch-brown);
            font-size: 1.8rem;
            margin-bottom: 20px;
            border-bottom: 3px solid var(--ranch-tan);
            padding-bottom: 15px;
        }

        .cost-highlight {
            background: linear-gradient(135deg, #FFF5E6, #FFE8CC);
            padding: 30px;
            border-radius: 8px;
            border-left: 5px solid var(--ranch-rust);
            margin: 25px 0;
        }

        .cost-highlight .big-number {
            font-size: 3rem;
            font-family: 'Crimson Pro', serif;
            font-weight: 700;
            color: var(--ranch-rust);
            margin-bottom: 10px;
        }

        .snapshot-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .snapshot-item {
            padding: 20px;
            background: var(--ranch-light);
            border-radius: 6px;
            border-left: 4px solid var(--ranch-sage);
        }

        .snapshot-item.critical {
            border-left-color: var(--ranch-rust);
            background: #FFF5F0;
        }

        .snapshot-item.warning {
            border-left-color: var(--ranch-tan);
            background: #FFF8ED;
        }

        .snapshot-item .emoji {
            font-size: 1.5rem;
            margin-bottom: 8px;
        }

        .snapshot-item .label {
            font-weight: 600;
            color: var(--ranch-brown);
            margin-bottom: 5px;
        }

        .cta-box {
            background: linear-gradient(135deg, var(--ranch-brown), var(--ranch-charcoal));
            color: white;
            padding: 50px;
            border-radius: 8px;
            text-align: center;
            margin-top: 40px;
            box-shadow: 0 8px 30px rgba(61, 40, 23, 0.3);
        }

        .cta-box h3 {
            font-family: 'Crimson Pro', serif;
            font-size: 2.2rem;
            margin-bottom: 20px;
        }

        .cta-box .benefits {
            text-align: left;
            max-width: 600px;
            margin: 30px auto;
        }

        .cta-box .benefits li {
            padding: 10px 0 10px 35px;
            position: relative;
            font-size: 1.1rem;
        }

        .cta-box .benefits li::before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: var(--ranch-tan);
            font-weight: bold;
            font-size: 1.3rem;
        }

        .cta-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 30px;
        }

        .btn-cta-primary {
            background: var(--ranch-tan);
            color: var(--ranch-brown);
            font-weight: 700;
            font-size: 1.2rem;
            padding: 20px 45px;
        }

        .btn-cta-primary:hover {
            background: var(--ranch-rust);
            color: white;
        }

        .btn-cta-secondary {
            background: transparent;
            color: white;
            border: 2px solid white;
        }

        .btn-cta-secondary:hover {
            background: white;
            color: var(--ranch-brown);
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .logo {
                font-size: 2rem;
            }

            h1 {
                font-size: 1.8rem;
            }

            .question-card {
                padding: 25px;
            }

            .score-number {
                font-size: 3.5rem;
            }

            .nav-buttons {
                flex-direction: column;
            }

            .cta-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="brought-by">Brought to you by</div>
            <div class="logo">THE SERVICE RANCH</div>
        </header>

        <!-- Introduction -->
        <div id="intro" class="intro-box">
            <h1>Are You Leaving $100K+ on the Table?</h1>
            <p class="subtitle">Most landscaping companies lose 6 figures annually to manual processes they don't even notice. Find out exactly where yours is going‚Äîin 3 minutes.</p>
            
            <div style="text-align: center; margin: 35px 0;">
                <button class="btn" onclick="startQuiz()" style="font-size: 1.3rem; padding: 22px 60px; box-shadow: 0 6px 25px rgba(184, 92, 56, 0.3);">Get My Revenue Score ‚Üí</button>
                <div style="margin-top: 12px; font-size: 0.9rem; color: var(--ranch-charcoal); opacity: 0.7;">3 minutes ‚Ä¢ Free ‚Ä¢ Instant results</div>
            </div>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 35px 0;">
                <div style="text-align: center; padding: 20px; background: var(--ranch-light); border-radius: 8px;">
                    <div style="font-size: 2.5rem; margin-bottom: 10px;">üí∞</div>
                    <div style="font-weight: 600; color: var(--ranch-brown);">Find Hidden Losses</div>
                    <div style="font-size: 0.9rem; color: var(--ranch-charcoal); opacity: 0.8;">Revenue leakage you can't see</div>
                </div>
                <div style="text-align: center; padding: 20px; background: var(--ranch-light); border-radius: 8px;">
                    <div style="font-size: 2.5rem; margin-bottom: 10px;">üìä</div>
                    <div style="font-weight: 600; color: var(--ranch-brown);">Your Custom Score</div>
                    <div style="font-size: 0.9rem; color: var(--ranch-charcoal); opacity: 0.8;">See where you stand</div>
                </div>
                <div style="text-align: center; padding: 20px; background: var(--ranch-light); border-radius: 8px;">
                    <div style="font-size: 2.5rem; margin-bottom: 10px;">üéØ</div>
                    <div style="font-weight: 600; color: var(--ranch-brown);">Fix What Matters</div>
                    <div style="font-size: 0.9rem; color: var(--ranch-charcoal); opacity: 0.8;">Prioritized action plan</div>
                </div>
            </div>

            <div style="text-align: center; margin-top: 25px; padding: 15px; background: linear-gradient(135deg, #FFF5E6, #FFE8CC); border-radius: 6px;">
                <div style="font-size: 0.95rem; color: var(--ranch-charcoal);"><strong>For landscaping companies doing $3M-$15M annually</strong></div>
            </div>
        </div>

        <!-- Progress Bar -->
        <div id="progress-container" class="hidden">
            <div class="progress-bar">
                <div class="progress-fill" id="progress"></div>
            </div>
        </div>

        <!-- Quiz Container -->
        <div id="quiz-container" class="hidden"></div>

        <!-- Navigation Buttons -->
        <div id="nav-buttons" class="nav-buttons hidden">
            <button class="btn btn-secondary" id="prev-btn" onclick="prevQuestion()">Previous</button>
            <button class="btn" id="next-btn" onclick="nextQuestion()">Next Question</button>
        </div>

        <!-- Email Capture -->
        <div id="email-capture" class="hidden">
            <h2>Get Your Detailed Results</h2>
            <p>Enter your email to receive your personalized AI Readiness Report with specific recommendations for your business.</p>
            <input type="email" id="email-input" placeholder="your.email@company.com" required>
            <button class="btn" onclick="submitEmail()">View My Results</button>
        </div>

        <!-- Results -->
        <div id="results" class="hidden"></div>
    </div>

    <script>
        // GOOGLE SHEETS CONFIGURATION
        // Instructions to set this up:
        // 1. Go to https://script.google.com
        // 2. Create a new project
        // 3. Paste this code:
        /*
        function doPost(e) {
            var sheet = SpreadsheetApp.openById('YOUR_SPREADSHEET_ID').getActiveSheet();
            var data = JSON.parse(e.postData.contents);
            
            sheet.appendRow([
                new Date(),
                data.email,
                data.totalScore,
                data.rating,
                data.estimatedLoss,
                JSON.stringify(data.answers),
                JSON.stringify(data.categoryScores)
            ]);
            
            return ContentService.createTextOutput(JSON.stringify({success: true}))
                .setMimeType(ContentService.MimeType.JSON);
        }
        */
        // 4. Deploy as web app (Anyone can access)
        // 5. Copy the deployment URL and paste it below
        const GOOGLE_SHEETS_URL = 'https://script.google.com/macros/s/AKfycbwUx_gyunuuD1zBuZsX6_wmvMmhrXnqefK8RGhkPp73nFeBj1MDd8Gujg-PCWf7UWcPAw/exec';
        
        const questions = [
            {
                id: 1,
                category: "Data Foundation",
                text: "Our customer service history and communication records are:",
                type: "single",
                options: [
                    { text: "Mostly paper/scattered", value: 1 },
                    { text: "Some digital but inconsistent", value: 2 },
                    { text: "Partially digitized", value: 3 },
                    { text: "Mostly digital and accessible", value: 4 },
                    { text: "Fully digital and integrated", value: 5 }
                ]
            },
            {
                id: 2,
                category: "Data Foundation",
                text: "I can pull an accurate profit/loss report for any specific job within:",
                type: "single",
                options: [
                    { text: "Can't do this", value: 1 },
                    { text: "Several days", value: 2 },
                    { text: "A few hours", value: 3 },
                    { text: "30 minutes", value: 4 },
                    { text: "5 minutes", value: 5 }
                ]
            },
            {
                id: 3,
                category: "Process Standardization",
                text: "Our standard operating procedures for common jobs are:",
                type: "single",
                options: [
                    { text: "In people's heads", value: 1 },
                    { text: "Verbally communicated", value: 2 },
                    { text: "Some written docs", value: 3 },
                    { text: "Documented and accessible", value: 4 },
                    { text: "Digital, updated, and consistently followed", value: 5 }
                ]
            },
            {
                id: 4,
                category: "Technology Infrastructure",
                text: "How many times does the same information get entered into different systems?",
                type: "single",
                options: [
                    { text: "3+ times regularly", value: 1 },
                    { text: "Usually twice", value: 2 },
                    { text: "Twice for some things", value: 3 },
                    { text: "Rarely duplicate entry", value: 4 },
                    { text: "Once - systems talk to each other", value: 5 }
                ]
            },
            {
                id: 5,
                category: "Technology Infrastructure",
                text: "Our crew timesheets and job hours are collected via:",
                type: "single",
                options: [
                    { text: "Paper timesheets entered manually", value: 1 },
                    { text: "Paper then transcribed into spreadsheets", value: 2 },
                    { text: "Mix of paper and digital", value: 3 },
                    { text: "Digital but someone has to manually enter into payroll/accounting", value: 4 },
                    { text: "Digital and auto-syncs to all systems", value: 5 }
                ]
            },
            {
                id: 6,
                category: "Administrative Efficiency",
                text: "How many administrative staff hours per week are spent on manual data entry?",
                type: "single",
                options: [
                    { text: "30+ hours", value: 1 },
                    { text: "20-30 hours", value: 2 },
                    { text: "10-20 hours", value: 3 },
                    { text: "5-10 hours", value: 4 },
                    { text: "Less than 5 hours", value: 5 }
                ]
            },
            {
                id: 7,
                category: "Business Metrics",
                text: "I know my gross profit margin by service line:",
                type: "single",
                options: [
                    { text: "No idea", value: 1 },
                    { text: "Rough guess", value: 2 },
                    { text: "Annual review only", value: 3 },
                    { text: "Monthly tracking", value: 4 },
                    { text: "Real-time visibility", value: 5 }
                ]
            },
            {
                id: 8,
                category: "Business Metrics",
                text: "When asked \"What's your biggest money leak?\", I:",
                type: "single",
                options: [
                    { text: "Can only guess", value: 1 },
                    { text: "Have hunches", value: 2 },
                    { text: "Have some data", value: 3 },
                    { text: "Can point to 2-3 areas with confidence", value: 4 },
                    { text: "Have detailed analysis with dollar amounts", value: 5 }
                ]
            },
            {
                id: 9,
                category: "Administrative Operations",
                text: "We currently have administrative assistants spending significant time on: (Select all that apply)",
                type: "multiple",
                options: [
                    { text: "Re-entering timesheet data from paper into payroll", value: 1 },
                    { text: "Manually entering job notes/details from field crews", value: 1 },
                    { text: "Reconciling information across multiple systems", value: 1 },
                    { text: "Chasing down crews for missing paperwork", value: 1 },
                    { text: "Re-typing invoice information", value: 1 },
                    { text: "Manually updating customer records in multiple places", value: 1 },
                    { text: "Transferring information from one software to another", value: 1 },
                    { text: "Creating reports by pulling data from multiple sources", value: 1 },
                    { text: "None of these", value: 0 }
                ]
            },
            {
                id: 10,
                category: "Automation Opportunity",
                text: "If we could eliminate duplicate data entry and automate administrative tasks, we could:",
                type: "single",
                options: [
                    { text: "Probably save a few hours per week", value: 1 },
                    { text: "Reduce admin workload by 25-50%", value: 2 },
                    { text: "Eliminate 1 full-time admin position or repurpose that role", value: 3 },
                    { text: "Eliminate multiple admin positions or significantly repurpose admin time", value: 4 },
                    { text: "We've already automated most of this", value: 5 }
                ]
            }
        ];

        let currentQuestion = 0;
        let answers = {};
        let userEmail = "";

        function startQuiz() {
            document.getElementById('intro').classList.add('hidden');
            document.getElementById('progress-container').classList.remove('hidden');
            document.getElementById('quiz-container').classList.remove('hidden');
            document.getElementById('nav-buttons').classList.remove('hidden');
            showQuestion(0);
        }

        function showQuestion(index) {
            const question = questions[index];
            const container = document.getElementById('quiz-container');
            
            let optionsHTML = '';
            if (question.type === 'single') {
                optionsHTML = question.options.map((opt, i) => `
                    <div class="option" onclick="selectOption(${index}, ${i}, ${opt.value})">
                        ${opt.text}
                    </div>
                `).join('');
            } else {
                optionsHTML = question.options.map((opt, i) => `
                    <label class="option checkbox-option">
                        <input type="checkbox" onchange="selectMultiple(${index}, ${i}, ${opt.value}, this.checked)">
                        <span>${opt.text}</span>
                    </label>
                `).join('');
            }

            container.innerHTML = `
                <div class="question-card">
                    <div class="question-number">Question ${index + 1} of ${questions.length}</div>
                    <div class="question-text">${question.text}</div>
                    <div class="options" id="options-${index}">
                        ${optionsHTML}
                    </div>
                </div>
            `;

            // Update progress
            const progress = ((index + 1) / questions.length) * 100;
            document.getElementById('progress').style.width = progress + '%';

            // Update navigation buttons
            document.getElementById('prev-btn').style.display = index === 0 ? 'none' : 'block';
            document.getElementById('next-btn').textContent = 
                index === questions.length - 1 ? 'See My Results' : 'Next Question';

            // Restore previous answer if exists
            if (answers[index] !== undefined) {
                if (question.type === 'single') {
                    const selectedIndex = question.options.findIndex(opt => opt.value === answers[index]);
                    if (selectedIndex !== -1) {
                        document.querySelectorAll(`#options-${index} .option`)[selectedIndex].classList.add('selected');
                    }
                } else {
                    const checkboxes = document.querySelectorAll(`#options-${index} input[type="checkbox"]`);
                    answers[index].forEach((val, i) => {
                        if (val > 0) checkboxes[i].checked = true;
                    });
                }
            }
        }

        function selectOption(questionIndex, optionIndex, value) {
            answers[questionIndex] = value;
            document.querySelectorAll(`#options-${questionIndex} .option`).forEach(opt => {
                opt.classList.remove('selected');
            });
            document.querySelectorAll(`#options-${questionIndex} .option`)[optionIndex].classList.add('selected');
        }

        function selectMultiple(questionIndex, optionIndex, value, checked) {
            if (!answers[questionIndex]) {
                answers[questionIndex] = new Array(questions[questionIndex].options.length).fill(0);
            }
            
            // If "None of these" is selected
            if (optionIndex === questions[questionIndex].options.length - 1 && checked) {
                answers[questionIndex] = new Array(questions[questionIndex].options.length).fill(0);
                answers[questionIndex][optionIndex] = value;
                document.querySelectorAll(`#options-${questionIndex} input[type="checkbox"]`).forEach((cb, i) => {
                    if (i !== optionIndex) cb.checked = false;
                });
            } else {
                // Uncheck "None of these" if anything else is selected
                if (checked) {
                    const noneCheckbox = document.querySelectorAll(`#options-${questionIndex} input[type="checkbox"]`)[questions[questionIndex].options.length - 1];
                    noneCheckbox.checked = false;
                    answers[questionIndex][questions[questionIndex].options.length - 1] = 0;
                }
                answers[questionIndex][optionIndex] = checked ? value : 0;
            }
        }

        function nextQuestion() {
            if (answers[currentQuestion] === undefined || 
                (Array.isArray(answers[currentQuestion]) && answers[currentQuestion].every(v => v === 0))) {
                alert('Please answer the current question before proceeding.');
                return;
            }

            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                showQuestion(currentQuestion);
            } else {
                showEmailCapture();
            }
        }

        function prevQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                showQuestion(currentQuestion);
            }
        }

        function showEmailCapture() {
            document.getElementById('quiz-container').classList.add('hidden');
            document.getElementById('nav-buttons').classList.add('hidden');
            document.getElementById('progress-container').classList.add('hidden');
            document.getElementById('email-capture').classList.remove('hidden');
        }

        function submitEmail() {
            const email = document.getElementById('email-input').value;
            if (!email || !email.includes('@')) {
                alert('Please enter a valid email address.');
                return;
            }
            userEmail = email;
            
            // Send to Google Sheets
            sendToGoogleSheets();
            
            showResults();
        }

        async function sendToGoogleSheets() {
            const { totalScore, categoryScores } = calculateScore();
            const maxScore = 50;
            const percentage = (totalScore / maxScore) * 100;

            let rating;
            if (percentage >= 85) {
                rating = "Ranch Boss";
            } else if (percentage >= 70) {
                rating = "Trail Boss";
            } else if (percentage >= 55) {
                rating = "Working the Ranch";
            } else if (percentage >= 40) {
                rating = "All Hands on Deck";
            } else {
                rating = "Lost in the Weeds";
            }

            const adminHours = 6 - answers[5];
            const dataEntryCount = answers[8] ? (Array.isArray(answers[8]) ? answers[8].reduce((a,b) => a+b, 0) : 0) : 0;
            const doubleEntryScore = 6 - answers[3];
            const estimatedAnnualLoss = 75000 + (adminHours * 15000) + (dataEntryCount * 8000) + (doubleEntryScore * 12000);

            const payload = {
                email: userEmail,
                totalScore: totalScore,
                rating: rating,
                estimatedLoss: estimatedAnnualLoss,
                answers: answers,
                categoryScores: categoryScores,
                timestamp: new Date().toISOString()
            };

            // Only send if URL is configured
            if (GOOGLE_SHEETS_URL && GOOGLE_SHEETS_URL !== 'PASTE_YOUR_DEPLOYMENT_URL_HERE' && !GOOGLE_SHEETS_URL.includes('PASTE_YOUR')) {
                try {
                    await fetch(GOOGLE_SHEETS_URL, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(payload)
                    });
                    console.log('Data sent to Google Sheets successfully');
                } catch (error) {
                    console.error('Error sending to Google Sheets:', error);
                }
            } else {
                console.log('Google Sheets not configured. Data:', payload);
            }
        }

        function calculateScore() {
            let totalScore = 0;
            let categoryScores = {};

            questions.forEach((q, i) => {
                if (Array.isArray(answers[i])) {
                    const sum = answers[i].reduce((a, b) => a + b, 0);
                    totalScore += Math.min(sum, 5); // Cap at 5 for multiple choice
                } else {
                    totalScore += answers[i];
                }

                if (!categoryScores[q.category]) {
                    categoryScores[q.category] = { score: 0, max: 0 };
                }
                if (Array.isArray(answers[i])) {
                    categoryScores[q.category].score += Math.min(answers[i].reduce((a, b) => a + b, 0), 5);
                } else {
                    categoryScores[q.category].score += answers[i];
                }
                categoryScores[q.category].max += 5;
            });

            return { totalScore, categoryScores };
        }

        function showResults() {
            document.getElementById('email-capture').classList.add('hidden');
            
            const { totalScore, categoryScores } = calculateScore();
            const maxScore = 50;
            const percentage = (totalScore / maxScore) * 100;

            let rating, ratingDescription;
            if (percentage >= 85) {
                rating = "Ranch Boss";
                ratingDescription = "Your systems are recovering revenue automatically";
            } else if (percentage >= 70) {
                rating = "Trail Boss";
                ratingDescription = "You're leading the way but leaving money on the table";
            } else if (percentage >= 55) {
                rating = "Working the Ranch";
                ratingDescription = "Solid operation, but manual processes are costing you";
            } else if (percentage >= 40) {
                rating = "All Hands on Deck";
                ratingDescription = "Too much manual work, not enough automation";
            } else {
                rating = "Lost in the Weeds";
                ratingDescription = "Your team is drowning in paperwork and duplicate entry";
            }

            // Calculate estimated losses
            const adminHours = 6 - answers[5]; // Inverted from question 6
            const dataEntryCount = answers[8] ? (Array.isArray(answers[8]) ? answers[8].reduce((a,b) => a+b, 0) : 0) : 0;
            const doubleEntryScore = 6 - answers[3]; // Inverted from question 4
            
            const estimatedAnnualLoss = 75000 + (adminHours * 15000) + (dataEntryCount * 8000) + (doubleEntryScore * 12000);
            const adminCost = 30000 + (adminHours * 8000);
            const timesheetCost = answers[4] < 3 ? 18000 : (answers[4] === 3 ? 10000 : 3000);

            const resultsHTML = `
                <div class="score-header">
                    <div style="font-size: 1.2rem; opacity: 0.9; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 2px;">Your Score</div>
                    <div class="score-number">${totalScore}/<span style="font-size: 3rem;">50</span></div>
                    <div class="score-label">"${rating}"</div>
                    <div class="score-description">${ratingDescription}</div>
                </div>

                <div class="results-section">
                    <h3>üí∞ Your Revenue Opportunity</h3>
                    <div class="cost-highlight">
                        <div style="text-align: center;">
                            <div style="font-size: 1rem; color: var(--ranch-rust); font-weight: 600; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px;">Estimated Annual Revenue Leakage</div>
                            <div class="big-number">$${estimatedAnnualLoss.toLocaleString()}</div>
                            <p style="margin-top: 15px; font-size: 1.05rem;">Based on your responses, your business is likely losing this amount annually to inefficiencies, manual processes, and missed opportunities that automation could solve.</p>
                        </div>
                    </div>

                    <h4 style="margin-top: 35px; color: var(--ranch-brown); font-family: 'Crimson Pro', serif; font-size: 1.4rem; border-bottom: 2px solid var(--ranch-tan); padding-bottom: 10px;">üí∏ Breaking Down Your Costs</h4>
                    
                    <div style="display: grid; gap: 20px; margin-top: 25px;">
                        <div style="padding: 20px; background: var(--ranch-light); border-radius: 8px; border-left: 4px solid var(--ranch-rust);">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                                <span style="font-size: 1.8rem;">üìù</span>
                                <strong style="color: var(--ranch-rust); font-size: 1.1rem;">Administrative Labor: $${adminCost.toLocaleString()}/year</strong>
                            </div>
                            <p style="margin-left: 44px; color: var(--ranch-charcoal); opacity: 0.9;">Manual data entry, reconciliation, chasing paperwork</p>
                        </div>

                        ${timesheetCost > 5000 ? `
                        <div style="padding: 20px; background: var(--ranch-light); border-radius: 8px; border-left: 4px solid var(--ranch-rust);">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                                <span style="font-size: 1.8rem;">‚è∞</span>
                                <strong style="color: var(--ranch-rust); font-size: 1.1rem;">Paper Timesheet Tax: $${timesheetCost.toLocaleString()}/year</strong>
                            </div>
                            <p style="margin-left: 44px; color: var(--ranch-charcoal); opacity: 0.9;">Crew time filling out paper + admin transcribing + reconciling + payroll verification = work done 2-3 times</p>
                        </div>
                        ` : ''}

                        <div style="padding: 20px; background: var(--ranch-light); border-radius: 8px; border-left: 4px solid var(--ranch-rust);">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                                <span style="font-size: 1.8rem;">üîÑ</span>
                                <strong style="color: var(--ranch-rust); font-size: 1.1rem;">Duplicate Entry & System Gaps: $${(doubleEntryScore * 12000).toLocaleString()}/year</strong>
                            </div>
                            <p style="margin-left: 44px; color: var(--ranch-charcoal); opacity: 0.9;">Errors from manual transfers, delayed invoicing, inaccurate job costing</p>
                        </div>

                        ${dataEntryCount > 2 ? `
                        <div style="padding: 20px; background: var(--ranch-light); border-radius: 8px; border-left: 4px solid var(--ranch-rust);">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                                <span style="font-size: 1.8rem;">üìã</span>
                                <strong style="color: var(--ranch-rust); font-size: 1.1rem;">Task Pile-Up: $${(dataEntryCount * 8000).toLocaleString()}/year</strong>
                            </div>
                            <p style="margin-left: 44px; color: var(--ranch-charcoal); opacity: 0.9;">You checked ${dataEntryCount} areas where admins spend significant time on manual work</p>
                        </div>
                        ` : ''}
                    </div>
                </div>

                <div class="results-section">
                    <h3>üìä Your Readiness Snapshot</h3>
                    <div class="snapshot-grid">
                        ${Object.entries(categoryScores).map(([category, data]) => {
                            const catPercentage = (data.score / data.max) * 100;
                            let emoji, cssClass, status;
                            if (catPercentage < 40) {
                                emoji = "üö®";
                                cssClass = "critical";
                                status = "Critical";
                            } else if (catPercentage < 60) {
                                emoji = "‚ö†Ô∏è";
                                cssClass = "warning";
                                status = "Needs Work";
                            } else {
                                emoji = "‚úÖ";
                                cssClass = "";
                                status = "Strong";
                            }
                            return `
                                <div class="snapshot-item ${cssClass}">
                                    <div class="emoji">${emoji}</div>
                                    <div class="label">${category}</div>
                                    <div style="font-size: 1.3rem; font-weight: 700; color: var(--ranch-brown); margin: 5px 0;">${data.score}/${data.max}</div>
                                    <div style="font-size: 0.85rem; color: var(--ranch-rust); font-weight: 600; text-transform: uppercase;">${status}</div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>

                <div class="results-section">
                    <h3>üéØ Here's Your Opportunity</h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 25px 0;">
                        <div style="text-align: center; padding: 25px; background: var(--ranch-light); border-radius: 8px;">
                            <div style="font-size: 2.5rem; margin-bottom: 10px;">üìÖ</div>
                            <div style="font-weight: 700; font-size: 1.8rem; color: var(--ranch-brown); margin-bottom: 5px;">30 Days</div>
                            <div style="font-size: 0.95rem; opacity: 0.85;">To see ROI from quick wins</div>
                        </div>
                        <div style="text-align: center; padding: 25px; background: var(--ranch-light); border-radius: 8px;">
                            <div style="font-size: 2.5rem; margin-bottom: 10px;">üíµ</div>
                            <div style="font-weight: 700; font-size: 1.8rem; color: var(--ranch-brown); margin-bottom: 5px;">$180K-$280K</div>
                            <div style="font-size: 0.95rem; opacity: 0.85;">Typical first-year recovery</div>
                        </div>
                    </div>

                    <p style="font-size: 1.05rem; line-height: 1.8; margin: 25px 0;">
                        <strong>Good news:</strong> Based on 200+ landscaping companies we've assessed, businesses at your readiness level 
                        typically recover <strong>$180,000-$280,000 in the first year</strong> by systematically addressing their biggest 
                        inefficiencies. The opportunities are there‚Äîyou just need to know where to look.
                    </p>

                    ${percentage < 70 ? `
                    <div style="background: #E8F5E9; padding: 25px; border-radius: 6px; margin-top: 25px; border-left: 4px solid var(--ranch-sage);">
                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 10px;">
                            <span style="font-size: 2rem;">üí°</span>
                            <strong style="color: var(--ranch-brown); font-size: 1.2rem;">Your Best Starting Point</strong>
                        </div>
                        <p style="line-height: 1.8; margin-left: 44px;">Your score suggests the biggest wins will come from automating administrative 
                        workflows and eliminating duplicate data entry. These changes typically show ROI within 30-60 days and require minimal behavior 
                        change from field crews‚Äîmaking them perfect quick wins while you build toward bigger improvements.</p>
                    </div>
                    ` : `
                    <div style="background: #E8F5E9; padding: 25px; border-radius: 6px; margin-top: 25px; border-left: 4px solid var(--ranch-sage);">
                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 10px;">
                            <span style="font-size: 2rem;">üåü</span>
                            <strong style="color: var(--ranch-brown); font-size: 1.2rem;">You're Ahead of the Curve</strong>
                        </div>
                        <p style="line-height: 1.8; margin-left: 44px;">Your strong foundation means you're ready for more advanced optimizations. 
                        Focus on predictive analytics, route optimization, and automated upselling to unlock the next level of efficiency and revenue growth.</p>
                    </div>
                    `}
                </div>

                <div class="cta-box">
                    <h3>üöÄ Ready to Recover That Revenue?</h3>
                    <p style="font-size: 1.15rem; margin-bottom: 25px;">
                        You've identified the gaps. Now let's plug them. Our <strong>Full AI Readiness Audit</strong> 
                        gives you the complete roadmap‚Äî75 questions across 12 categories that pinpoint exactly where to start.
                    </p>
                    
                    <ul class="benefits">
                        <li>Detailed diagnostic across every operational area</li>
                        <li>Custom 90-day implementation roadmap prioritized by ROI</li>
                        <li>Specific ROI projections for each recommended solution</li>
                        <li>Benchmark comparison against 200+ landscaping companies</li>
                        <li>Priority fixes ranked by financial impact</li>
                        <li>30-minute strategy call with a Service Ranch consultant</li>
                    </ul>

                    <div style="background: rgba(255, 255, 255, 0.15); padding: 25px; border-radius: 8px; margin: 30px 0;">
                        <p style="font-size: 1.4rem; font-weight: 700; margin-bottom: 15px;">
                            Investment: <span style="color: var(--ranch-tan); font-size: 1.8rem;">$49</span> <span style="text-decoration: line-through; opacity: 0.6; font-size: 1.3rem;">$99</span>
                        </p>
                        <p style="font-size: 1rem; opacity: 0.95; margin-bottom: 0;">
                            <strong>Our Guarantee:</strong> If we don't identify at least $50,000 in recoverable revenue opportunities, 
                            we'll refund your $49‚Äîno questions asked.
                        </p>
                    </div>

                    <div style="text-align: center; margin-top: 30px;">
                        <button class="btn btn-cta-primary" onclick="window.location.href='https://calendly.com/dallin-wardrop-vpij/30min'" style="font-size: 1.3rem; padding: 22px 50px;">Get the Full Audit ‚Üí</button>
                    </div>

                    <p style="font-size: 0.85rem; margin-top: 25px; opacity: 0.8;">
                        <em>Already working with us? The full audit is included in your Revenue Roundup engagement.</em>
                    </p>
                </div>
            `;

            document.getElementById('results').innerHTML = resultsHTML;
            document.getElementById('results').classList.remove('hidden');

            // Scroll to top of results
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // Log results (in production, send to your backend)
            console.log('Assessment Complete', {
                email: userEmail,
                score: totalScore,
                rating: rating,
                answers: answers,
                categoryScores: categoryScores
            });
        }
    </script>
</body>
</html>